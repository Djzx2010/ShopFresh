<!DOCTYPE html>
<html lang="eng" dir="ltr">

</html>

<head>
    <meta charset="UTF-8" name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop Fresh - Shopping Cart</title>
    <link rel="stylesheet" href="shopcart.css">
</head>
<body>
<!-- header -->
<div class="Header">
    <h1>
        ShopFresh - Shopping Cart</h1>
</div>
<div class=" w1200">
    <div class="continueShopping">
        <p class="CS">
            <a href="ShopFreshFrontPage.html">Continue Shopping </a>
        </p>
    </div>
    <!-------------------------------------------------------------------------------------------------------------
-->
    <div class="itemList">
        <div class="shoppingList" border="1px solid" id="itemList">
        </div>
    </div>
    <!-------------------------------------------------------------------------------------------------------------->
    <div class="price">
        <table class="checkOut" border="0px solid" style="text-align: right;">
            <tr>
                <td>
                    <button onclick="checkout()">
                        Check Out</button>
                </td>
            </tr>
            <tr>
                <td>
                    Sous-total Items:
                </td>
                <td id="sousTotal">
                </td>
            </tr>
            <tr>
                <td>
                    QST:
                </td>
                <td id="QST">
                </td>
            </tr>
            <tr>
                <td>
                    GST:
                </td>
                <td id="GST">
                </td>
            </tr>
            <tr>
                <td>
                    Price Total:
                </td>
                <td id="pricePlusTaxes">
                </td>
            </tr>
        </table>
    </div>
    <!--Return to Main page-->
    <div class="ReturnHome">
        <p class="RH">
            <a href="ShopFreshFrontPage.html">Home </a>
        </p>
    </div>
</div>
<!-- footer includes student information -->
<div class="Footer">
    <h3>
        Derek Lam(40132682), Mathieu Morier(40181304), Alexandra Charland(40061073), Jizhou
        Yang(40033034), Leon Zhang(40175616), Zebran Kamruzzaman(40065230)</h3>
</div>
<script>
        const table = document.getElementById("itemList");

        const sousTotal = document.getElementById("sousTotal");
        const QST = document.getElementById("QST");
        const GST = document.getElementById("GST");
        const pricePlusTaxes = document.getElementById("pricePlusTaxes");


        const cart = [{
                name: "Strawberries",
                price: 4.99,
                quantity: 1
            }, {
                name: "Banana",
                price: 1.79,
                quantity: 1
            }, {
                name: 'Eggs',
                price: 2.99,
                quantity: 1
            },
            {
                name: 'Salmon',
                price: 6.99,
                quantity: 1
            }, {
                name: 'Chicken',
                price: 14.39,
                quantity: 1
            }
        ];
        console.log(cart[0].name);


        //-------------------------------------------------------------------------
        //Add items
        function addItem(name, price) {
            // Check if there is the same item in the shopping cart
            for (let i = 0; i < cart.length; i += 1) {
                if (cart[i].name === name) {
                    cart[i].quantity += 1;
                    return
                }
            }

            // Push new item to the array cart
            const item = {
                name,
                price,
                quantity: 1
            };
            cart.push(item);
        }

        //-------------------------------------------------------------------------------
        // Show items
        function showItem() {
            //Display total quantity
            console.log(`You have ${getQuantity()} items in your carts`);

            // Print all items informations

            let itemRow =
                '<div> <span>Name</span> <span>Price/item</span> <span>Quantity</span> <span>Total</span> <span>Change Quantity</span> <span>Delete Item</span> </div>';
            for (let i = 0; i < cart.length; i += 1) {
                cart[i].quantity = (sessionStorage.getItem(cart[i].name) || 1);

                console.log(`${cart[i].name} $${cart[i].price} x ${cart[i].quantity}`);
                itemRow += `<div>
                           <span>${cart[i].name}</span>
                           <span>$${cart[i].price}</span>
                           <span>${cart[i].quantity}</span>
                           <span> $ ${(cart[i].price * cart[i].quantity).toFixed(2)}</span>
                           <span><button onclick="addQuantity(${i})">Add</button> <button onclick="removeQuantity(${i})">Remove</button></span>
                           <span><button onclick="removeItem(${i})">Delete</button></span>
                           </div>`;
            }
            table.innerHTML = itemRow;

            //Display total price
            console.log(`Total price is ${getTotalPrice()}`);

        }

        //--------------------------------------------------------------------------------------
        //Get the total quantity
        function getQuantity() {
            let totalQuantity = 0;
            for (let i = 0; i < cart.length; i += 1) {
                totalQuantity = totalQuantity + cart[i].quantity
            }
            return totalQuantity;
        }

        //---------------------------------------------------------------------------------------
        // Get the total price
        function getTotalPrice() {
            let totalPrice = 0;
            for (let i = 0; i < cart.length; i += 1) {
                totalPrice += cart[i].price * cart[i].quantity;
            }
            return totalPrice.toFixed(2);
        }

        //---------------------------------------------------------------------------------------------
        //Remove Item
        function removeItem(i) {
            sessionStorage.setItem(cart[i].name, 0)
            cart.splice(i, 1);
            showItem();
        }
        //--------------------------------------------------------------------------------------------------
        //Add one unit of an item by clicking on the button
        function addQuantity(i) {
            cart[i].quantity++;
            sessionStorage.setItem(cart[i].name, cart[i].quantity);
            showItem();
        }
        //--------------------------------------------------------------------------------------------------
        //Remove one unit of an item by clicking on the button
        function removeQuantity(i) {
            if (cart[i].quantity == 0) {
                return
            } else {
                cart[i].quantity--;
                sessionStorage.setItem(cart[i].name, cart[i].quantity);
                showItem();
            }
        }

        //------------------------------------------------------------------------------------
        //Executed when checkout button is selected
        function checkout() {
            let total = Number(getTotalPrice());
            let qst = Number((getTotalPrice() * 0.10).toFixed(2));
            let gst = Number((getTotalPrice() * 0.05).toFixed(2));
            sousTotal.innerHTML = `$ ${total.toFixed(2)}`;
            QST.innerHTML = `$ ${qst.toFixed(2)}`;
            GST.innerHTML = `$ ${gst.toFixed(2)}`;
            pricePlusTaxes.innerHTML = `$ ${(total+qst+gst).toFixed(2)}`;
        }

        showItem();
    </script>
</body>
</html>